<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Guía Turística – Viaje a Segovia y alrededores</title>
  <style>
    /* Paleta alegre: base clara + acentos vivos */
    :root{
      --bg:#f7f9fb;            /* fondo principal */
      --ink:#1f2937;           /* texto principal (gris-azul) */
      --muted:#6b7280;         /* texto secundario */
      --card:#ffffff;          /* tarjetas */
      --line:#e5e7eb;          /* bordes suaves */
      --brand:#0ea5e9;         /* azul cielo */
      --brand-2:#22c55e;       /* verde menta */
      --brand-3:#f59e0b;       /* amarillo mango */
      --grad1:#A7F3D0;         /* verde pastel */
      --grad2:#93C5FD;         /* azul pastel */
    }
    *{ box-sizing:border-box }
    html,body{ height:100% }
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Noto Sans", Arial;
      color:var(--ink);
      background:
        radial-gradient(1200px 600px at 10% -10%, var(--grad1) 0%, transparent 60%),
        radial-gradient(1000px 500px at 110% 0%, var(--grad2) 0%, transparent 55%),
        var(--bg);
    }

    /* Encabezado con gradiente alegre */
    header{
      position:sticky; top:0; z-index:10;
      background:linear-gradient(90deg, #10b981, #06b6d4, #3b82f6);
      color:#fff;
      border-bottom:1px solid #00000014;
      box-shadow:0 6px 20px rgba(16,185,129,.25);
    }
    .wrap{ max-width:1100px; margin:0 auto; padding:16px }
    h1{ margin:0; font-size:22px; letter-spacing:.2px }
    .muted{ color:#e9eef7; opacity:.9; font-size:13px; margin-top:4px }

    /* Tabs con píldoras de colores */
    .tabs{ display:flex; gap:8px; flex-wrap:wrap; margin:16px 0 18px }
    .tab{
      padding:10px 14px; border:1px solid var(--line);
      background:#ffffffc9; color:#0f172a;
      border-radius:999px; cursor:pointer; user-select:none;
      box-shadow:0 1px 0 #00000008, 0 6px 16px #0000000a;
      transition:transform .05s ease, box-shadow .2s ease, background .2s ease;
    }
    .tab:hover{ transform:translateY(-1px); box-shadow:0 10px 20px #00000014 }
    .tab.active{
      background:linear-gradient(90deg, #22c55e, #06b6d4);
      color:white; border-color:transparent;
      box-shadow:0 8px 18px rgba(6,182,212,.35);
    }

    /* Tarjeta de ciudad */
    .city{
      background:var(--card);
      border:1px solid var(--line);
      border-radius:16px;
      padding:14px;
      box-shadow:0 12px 30px #00000010;
    }
    .cityTitle{ margin:4px 8px 14px; font-size:20px }

    /* Acordeones H2 */
    .h2{
      margin:12px 0;
      border:1px solid var(--line);
      border-radius:14px; overflow:hidden;
      background:#ffffff;
      box-shadow:0 4px 14px #0000000a;
      transition:box-shadow .2s ease, transform .05s ease;
    }
    .h2:hover{ transform:translateY(-1px); box-shadow:0 12px 24px #00000012 }
    .h2 > summary{
      list-style:none; cursor:pointer; padding:12px 16px;
      background:linear-gradient(90deg,#ffffff 0%,#f8fafc 100%);
      font-weight:700; color:#0f172a;
      border-bottom:1px solid var(--line);
    }
    .h2 > summary::-webkit-details-marker{ display:none }

    /* Subacordeones H3 con acento lateral */
    .h3{ border-top:1px solid var(--line) }
    .h3 summary{
      list-style:none; cursor:pointer; padding:10px 16px;
      color:var(--muted); position:relative;
    }
    .h3[open] summary{ color:#0f172a; font-weight:600 }
    .h3 summary::before{
      content:""; position:absolute; left:0; top:0; bottom:0; width:4px;
      background:linear-gradient(180deg, var(--brand), var(--brand-3));
      border-top-right-radius:4px; border-bottom-right-radius:4px;
      opacity:.0; transition:opacity .2s ease;
    }
    .h3[open] summary::before{ opacity:1 }

    .content{
      padding:0 16px 14px;
      white-space:pre-wrap; line-height:1.6; color:#111827;
      background:conic-gradient(from 180deg at 0% 0%, #ffffff, #fbfdff);
    }
    code, kbd{ background:#f1f5f9; padding:.1em .35em; border-radius:6px; border:1px solid #e2e8f0 }

    /* Pequeños ajustes responsivos */
    @media (max-width: 700px){
      .tabs{ gap:6px }
      .tab{ padding:8px 12px }
      .city{ padding:10px }
    }
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <h1>Guía Turística – Viaje a Segovia y alrededores</h1>
      <p class="muted">Se muestra exactamente lo que hay en el JSON. Sin resúmenes. Solo colorcito del bueno.</p>
    </div>
  </header>

  <main class="wrap">
    <nav id="tabs" class="tabs" aria-label="Ciudades"></nav>
    <section id="panel" class="city" aria-live="polite"></section>
  </main>

  <script>
  const tabs = document.getElementById("tabs");
  const panel = document.getElementById("panel");
  let DATA = { ciudades: [] }, active = 0;

  const candidates = [
    "/all_guides.json",
    "all_guides.json",
    "/guia_turistica_completa.json",
    "guia_turistica_completa.json"
  ];

  (async () => {
    let raw = null, tried = [];
    for (const base of candidates) {
      const url = base + (base.includes("?") ? "&" : "?") + "ts=" + Date.now();
      try {
        const r = await fetch(url, { cache: "no-store" });
        tried.push(`${url} -> ${r.status}`);
        if (!r.ok) continue;
        raw = await r.json();
        console.log("JSON cargado desde:", url);
        break;
      } catch (e) {
        tried.push(`${url} -> ERROR ${e.message}`);
        console.warn("Fallo cargando", url, e);
      }
    }
    if (!raw) {
      panel.innerHTML = `
        <div style="padding:14px;background:#fee;border:1px solid #fca5a5;border-radius:12px;color:#7f1d1d">
          <b>❌ No se pudo cargar el JSON.</b><br>
          Rutas probadas:<br>
          <code>${tried.map(escapeHtml).join("<br>")}</code><br><br>
          Asegúrate de que el archivo esté en la <b>raíz</b> junto a <code>index.html</code> y se llame
          <code>all_guides.json</code> o <code>guia_turistica_completa.json</code> (con las <b>mayúsculas</b> bien).
        </div>`;
      return;
    }
    DATA = normalize(raw);
    renderTabs();
    selectCity(0);
  })();

  // Acepta {ciudades:[...]} o {guides:[...]} o {title,sections}
  function normalize(raw){
    if (Array.isArray(raw?.ciudades)) return raw;
    if (Array.isArray(raw?.guides)) {
      return {
        ciudades: raw.guides.map(g => ({
          nombre: g.title ?? "Sin título",
          lugares: (g.sections||[]).map(sec => ({
            titulo: sec.subtitle ?? "Sin título",
            subapartados: (sec.items||[]).map(it => ({
              subtitulo: it.title ?? "",
              texto: it.content ?? ""
            }))
          }))
        }))
      };
    }
    if (raw?.title && Array.isArray(raw?.sections)) return normalize({ guides:[raw] });
    return { ciudades: [] };
  }

  function renderTabs(){
    tabs.innerHTML = DATA.ciudades.map((c,i) =>
      `<button class="tab ${i===active?"active":""}" data-i="${i}">${escapeHtml(c.nombre||"Sin nombre")}</button>`
    ).join("");
    tabs.querySelectorAll(".tab").forEach(btn=>{
      btn.addEventListener("click", () => selectCity(Number(btn.dataset.i)));
    });
  }

  function selectCity(i){
    active = i;
    tabs.querySelectorAll(".tab").forEach((b,j)=>b.classList.toggle("active", j===i));
    const city = DATA.ciudades[i];
    if(!city){ panel.innerHTML="<p>No hay datos.</p>"; return; }

    panel.innerHTML = `
      <h2 class="cityTitle">${escapeHtml(city.nombre||"")}</h2>
      ${ (city.lugares||[]).map((lugar,idx)=> `
        <details class="h2" id="h2-${idx}">
          <summary>${escapeHtml(lugar.titulo||"Sin título")}</summary>
          ${ renderSubapartados(lugar.subapartados||[]) }
        </details>
      `).join("") }
    `;
  }

  function renderSubapartados(items){
    if(!items.length) return `<div class="content" style="color:var(--muted)">Sin subapartados</div>`;
    return items.map(sp => `
      <details class="h3">
        <summary>${escapeHtml(sp.subtitulo||"")}</summary>
        <div class="content">${escapeHtml(sp.texto||"").replace(/\n/g,"<br>")}</div>
      </details>
    `).join("");
  }

  function escapeHtml(s){
    return String(s??"").replace(/[&<>"']/g, m =>
      ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m])
    );
  }
</script>

</body>
</html>



